# BoxelGame 開発計画

## プロジェクト概要

BoxelGameは、C++23とModern OpenGLを使用したMinecraft風のボクセルサンドボックスゲームです。
技術デモとして、RAII原則、ECS アーキテクチャ、マルチプラットフォーム対応を重視した実装を行います。

---

## 開発フェーズ

### フェーズ1: ビルドシステムの完成 ✅

#### 完了済み項目
- [x] CMake ビルドシステム構築
- [x] 全プリセット (default, release, windows-debug, windows-release, coverage) 対応
- [x] doctest 統合とテスト実行
- [x] GitHub Actions CI/CD パイプライン構築
  - [x] マルチプラットフォーム (Ubuntu, Windows, macOS) ビルド
  - [x] Debug/Release ビルドマトリックス
  - [x] 自動テスト実行
  - [x] 静的解析統合 (clang-tidy)
  - [x] コードフォーマット検証 (clang-format)
- [x] 依存関係管理 (CPM.cmake)
  - [x] GLFW 3.4
  - [x] spdlog 1.15.3
  - [x] GLM 1.0.1
  - [x] doctest 2.4.12
  - [x] GLAD (OpenGL loader)
- [x] マルチプラットフォームビルド検証
- [x] リリースパッケージング自動化
- [x] カバレッジ測定統合

### フェーズ2: 基盤システム構築 🚀 次期実装

#### ECS (Entity Component System) 実装
- [ ] EnTT ライブラリ統合
- [ ] 基本コンポーネント設計
  - [ ] Transform コンポーネント (位置・回転・スケール)
  - [ ] Mesh コンポーネント (3Dモデルデータ)
  - [ ] Material コンポーネント (マテリアル設定)
  - [ ] Physics コンポーネント (物理属性)
- [ ] システム基盤クラス設計
- [ ] コンポーネント間通信システム

#### レンダリングパイプライン
- [ ] シェーダーシステム実装
  - [ ] 頂点シェーダー (MVP 変換)
  - [ ] フラグメントシェーダー (基本ライティング)
  - [ ] シェーダープログラム管理クラス
- [ ] VBO/VAO レンダリングシステム
- [ ] テクスチャ管理システム
- [ ] カメラシステム
  - [ ] パースペクティブ射影
  - [ ] ビュー行列計算
  - [ ] フライカメラ実装

### フェーズ3: 物理・入力システム

#### 物理エンジン統合
- [ ] Bullet Physics ライブラリ統合
- [ ] 剛体物理システム実装
- [ ] 衝突検出システム
- [ ] 重力・落下システム
- [ ] レイキャスト機能

#### 入力システム
- [ ] 入力イベントシステム設計
- [ ] キーボード入力処理
  - [ ] WASD 移動
  - [ ] Space ジャンプ
  - [ ] Shift ダッシュ
- [ ] マウス入力処理
  - [ ] 視点操作 (Look around)
  - [ ] 左クリック (ブロック破壊)
  - [ ] 右クリック (ブロック配置)

#### プレイヤーキャラクター
- [ ] プレイヤーエンティティ設計
- [ ] 一人称視点カメラ
- [ ] 移動・ジャンプ物理
- [ ] 当たり判定システム

### フェーズ4: ボクセルシステム

#### チャンクシステム
- [ ] ボクセルデータ構造設計 (16³ blocks/chunk)
- [ ] チャンクマネージャー実装
- [ ] メモリ効率的ストレージ
- [ ] チャンク境界処理

#### メッシュ生成
- [ ] Greedy Meshing アルゴリズム実装
- [ ] Face Culling システム (隠れ面削除)
- [ ] インスタンスレンダリング
- [ ] LOD (Level of Detail) システム
- [ ] メッシュキャッシング

#### 地形生成
- [ ] 3D Perlin/Simplex ノイズ実装
- [ ] 地形生成アルゴリズム
  - [ ] 高度マップ生成
  - [ ] バイオーム分布
  - [ ] 鉱石配置
- [ ] 洞窟生成システム

### フェーズ5: ゲームプレイ

#### ブロック操作システム
- [ ] ブロック配置システム
- [ ] ブロック破壊システム
- [ ] レイキャスティング (ブロック選択)
- [ ] ブロックタイプ管理
- [ ] インベントリシステム

#### モブ (Mob) システム
- [ ] モブ基底クラス設計
- [ ] 基本AI実装
  - [ ] ゾンビ (追跡AI)
  - [ ] スパイダー (ジャンプ移動)
  - [ ] スケルトン (遠距離攻撃)
- [ ] スポーンシステム
  - [ ] 光レベル依存スポーン
  - [ ] 昼夜サイクル対応
- [ ] 敵対行動・ダメージシステム

#### ゲームモード
- [ ] ゲーム状態管理システム
- [ ] クリエイティブモード
  - [ ] 無限リソース
  - [ ] 飛行モード
  - [ ] 無敵モード
- [ ] サバイバルモード
  - [ ] ヘルスシステム
  - [ ] 空腹度システム
  - [ ] アイテムドロップ

### フェーズ6: データ永続化・最適化

#### セーブ・ロードシステム
- [ ] SQLite データベース統合
- [ ] ワールドデータ保存システム
  - [ ] チャンクデータシリアライゼーション
  - [ ] プレイヤー状態保存
  - [ ] ゲーム設定保存
- [ ] 自動セーブ機能 (5分間隔)
- [ ] セーブファイル管理

#### パフォーマンス最適化
- [ ] フラスタムカリング実装
- [ ] オクルージョンカリング
- [ ] メモリプール管理
- [ ] マルチスレッド最適化
  - [ ] チャンク生成並列化
  - [ ] メッシュ生成並列化

#### UI システム
- [ ] Dear ImGui 統合
- [ ] ゲーム内UI
  - [ ] HUD (ヘルス・空腹度表示)
  - [ ] インベントリ画面
  - [ ] 設定メニュー
  - [ ] ポーズメニュー
- [ ] デバッグ情報表示
  - [ ] FPS カウンター
  - [ ] メモリ使用量
  - [ ] 描画統計

---

## 技術仕様概要

### 開発環境
- **言語**: C++23
- **ビルドシステム**: CMake 3.19+ with Presets
- **CI/CD**: GitHub Actions
- **静的解析**: clang-tidy
- **フォーマット**: clang-format
- **テスト**: doctest

### 主要ライブラリ依存関係
| カテゴリ | ライブラリ | バージョン | 状況 |
|---------|-----------|-----------|------|
| ウィンドウ | GLFW | 3.4.0 | ✅ 統合済み |
| OpenGL | GLAD | 2.0.x | ✅ 統合済み |
| 数学 | GLM | 1.0.1 | ✅ 統合済み |
| ログ | spdlog | 1.15.3 | ✅ 統合済み |
| テスト | doctest | 2.4.12 | ✅ 統合済み |
| ECS | EnTT | 3.15.0 | ⏳ 予定 |
| 物理 | Bullet Physics | 3.25 | ⏳ 予定 |
| UI | Dear ImGui | 1.92.0 | ⏳ 予定 |
| オーディオ | OpenAL Soft | 1.24.3 | ⏳ 予定 |
| DB | SQLite | 3.50.2 | ⏳ 予定 |
| 画像 | stb_image | master | ⏳ 予定 |

---

## タイムライン

### 短期 (第2-4週) - フェーズ2
1. EnTT 統合とECS基盤実装
2. 基本レンダリングパイプライン
3. シェーダーシステム構築

### 中期 (第5-8週) - フェーズ3
1. Bullet Physics 統合
2. 入力システム完成
3. プレイヤーキャラクター実装

### 中期 (第9-12週) - フェーズ4
1. ボクセルエンジン中核実装
2. チャンクシステム
3. 地形生成

### 長期 (第13-16週) - フェーズ5-6
1. ゲームプレイ要素
2. UI システム
3. 最適化・ポリッシュ

---

## 品質基準

### パフォーマンス目標
- **フレームレート**: 30 FPS以上 (GTX 760 + i5-4690)
- **メモリ使用量**: 4 GB以内 (8 GB環境)
- **解像度**: 1920×1080
- **ロード時間**: ワールド初期化 ≤ 5秒

### コード品質
- **テストカバレッジ**: 80%以上
- **静的解析**: clang-tidy 警告ゼロ
- **フォーマット**: clang-format 準拠
- **文書化**: 主要クラス・関数にコメント

### CI/CD 基準
- **ビルド**: 全プラットフォームで成功
- **テスト**: 全テストケース通過
- **デプロイ**: 自動リリースアーティファクト生成

---

## リスク管理

### 技術リスク
- **パフォーマンス**: 早期プロファイリングで対策
- **WSL互換性**: 継続的な検証
- **依存関係**: CPM.cmake による自動管理

### スコープリスク
- **機能過多**: MVP第一、段階的拡張
- **技術負債**: 定期的リファクタリング
- **時間超過**: フェーズ単位での評価・調整